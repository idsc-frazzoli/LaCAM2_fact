<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LaCAM2_fact: LaCAM2_fact</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_space.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LaCAM2_fact
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">LaCAM2_fact </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> [<img src="http://img.shields.io/badge/license-MIT-blue.svg?style=flat" alt="MIT License" style="pointer-events: none;" class="inline"/>](LICENSE) <a href="https://github.com/Kei18/lacam2/actions/workflows/ci.yml"><img src="https://github.com/Kei18/lacam2/actions/workflows/ci.yml/badge.svg" alt="CI" style="pointer-events: none;" class="inline"/></a></p>
<p>This is a factorized version of the LaCAM2 algorithm from Keisuke Okumura.</p>
<p>Do you want the power? LaCAM* could be the answer.</p>
<p>The original work is from code repository of the paper <a href="https://kei18.github.io/lacam2/">"Improving LaCAM for Scalable Eventually Optimal Multi-Agent Pathfinding"</a> (IJCAI-23), extended from from <a href="https://kei18.github.io/lacam/">the LaCAM repo</a> presented at AAAI-23.</p>
<h1><a class="anchor" id="autotoc_md0"></a>
Building</h1>
<p>To build the project you need is <a href="https://cmake.org/">CMake</a> (â‰¥v3.16). The code is written in C++(17).</p>
<p>First, clone this repo with submodules.</p>
<div class="fragment"><div class="line">git clone https://github.com/idsc-frazzoli/LaCAM2_fact.git</div>
</div><!-- fragment --><p>Depending on the configuration of your environnement, you might also need other linux libraries such as qt-5-default. To install the required packages, run the following command.</p>
<div class="fragment"><div class="line">sudo apt-get install qtbase5-dev qtchooser qt5-qmake qtbase5-dev-tools</div>
</div><!-- fragment --><p>Then dowload the required submodules. This project uses two submodules: <a href="https://github.com/p-ranav/argparse">argparse</a> by P-Ranav and <a href="https://github.com/yse/easy_profiler">easy_profiler</a> by yse.</p>
<div class="fragment"><div class="line">cd LaCAM2_fact</div>
<div class="line">git submodules init</div>
<div class="line">git submodules update</div>
</div><!-- fragment --><p>Finally, you can build the project.</p>
<div class="fragment"><div class="line">cmake -B build &amp;&amp; make -C build -j4</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1"></a>
Usage</h1>
<p>Basic run with 50 agents on the 'random-32-32-20' map. The important arguments are : -i : the path to the .scen file specifying the start and goal location for every agent. -m : the path to the .map file of the given problem. -N : the number of agents. -v : the verbosity level. for -v 0, the code will not provide any output to the terminal.</p>
<p>Try running the following command :</p>
<div class="fragment"><div class="line">&gt; build/main -i assets/maps/random-32-32-20/other_scenes/random-32-32-20-700.scen -m assets/maps/random-32-32-20/random-32-32-20.map -N 10 -v 1</div>
<div class="line">solved: 1ms     makespan: 47 (lb=47, ub=1)      sum_of_costs: 1297 (lb=1098, ub=1.19)   sum_of_loss: 1198 (lb=1098, ub=1.1)</div>
</div><!-- fragment --><p>There are other arguments you can specify in order to use all the feature of LaCAM2_fact :</p>
<ul>
<li><code>-mt</code> (or <code>--multi_threading</code>): This argument toggles whether the program uses multiple cores to solve MAPF instances in parallel (if applicable). By defauly it is set to false. use <code>-mt</code> or <code>-mt yes</code> to enable multi threading.</li>
<li><code>-f</code> (or <code>--factorize</code>): This argument specifies the mode of factorization to be used in the solving process. The options are standard, <a class="el" href="classFactDistance.html" title="Implements manhattan-distance-based factorization heuristic.">FactDistance</a>, <a class="el" href="classFactBbox.html" title="Implements Bounding-Box-based factorization heuristic.">FactBbox</a>, Factorient, <a class="el" href="classFactAstar.html" title="Class that implements A* distance-based factorization heuristic.">FactAstar</a>, or <a class="el" href="classFactDef.html" title="Class that implements factorization using pre-computed partitions.">FactDef</a>, with the default being standard. This determines how the algorithm factorizes the problem for more efficient solving.</li>
<li><code>-s</code> (or <code>--save_stats</code>): This argument toggles whether the program should save statistics about the run. The satistics are saved in the <code>stats.json</code> file. By default, it is set to true. Use <code>-s false</code> to disable saving statistics.</li>
<li><code>-sp</code> (or <code>--save_partitions</code>): This argument controls whether the program saves the partitions generated during the solving process. By default, it is set to false. Use <code>-sp</code> to enable saving partitions.</li>
</ul>
<p>You can find details of all parameters with: </p><div class="fragment"><div class="line">build/main --help</div>
</div><!-- fragment --><p>Note that some parameters are only compatible with the standard version and some others only with the factorized verison of LaCAM2.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Visualizer</h1>
<p>This repository is compatible with <a href="https://github.com/kei18/mapf-visualizer">@Kei18/mapf-visualizer</a>.</p>
<p align="center"><img src="assets/misc/MAPF_viz_snapshot.png" alt="" width="50%" class="inline"/> <br  />
 </p>
<p>Example with 200 agents in random-32-32-20.map</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Data visualization</h1>
<p>Once you ran a couple tests, you can visualize the .json files using a dedicated dashboard in the <code>assets</code> folder. To use this script, run it from the command line with the required and optional arguments.The <code>--map_name</code> argument is mandatory and specifies the name of the map to display. Optionally, you can provide the <code>--read_from</code> argument to specify a file to read data from , and the <code>--theme argument</code> to set the application theme to either 'dark' or 'light' (default is 'dark').</p>
<div class="fragment"><div class="line">python3 assets/dashboard.py --map_name random-32-32-10 --read_from stats.json --theme dark</div>
</div><!-- fragment --><p>The dashboard contains a lot of interesting data, starting with simple general information about the tests (what map, how many agents, how many tests). Then some information about the current hardware of the machine (careful, this data does not represent the hardware used to generate a given .json file).</p>
<p>The two graphs on the top right represent the succes rate of the different algorithms in %. The first row of charts is for sequential solving of MAPF instances and the second row is about the multi-threaded solving (MT). The solving times are averaged out and plotted as a function of the agent number in the map. Information about the variance can be viewed in the center charts. The charts on the far right depict the successfully solved instances as a function of agent number.</p>
<p>The fourth row shows data about average CPU and maximum RAM usage during the solving.</p>
<p align="center"><img src="assets/misc/screenshot_dashboard.png" alt="" width="100%" class="inline"/> <br  />
 </p>
<p>Screenshot of the dashboard.</p>
<h1><a class="anchor" id="autotoc_md4"></a>
Documentation</h1>
<p>The [docs](docs) folder contains the documentation of this project. It is accessible via the <code>Documentation</code> link in the root folder.</p>
<p><img src="assets/misc/screenshot_doc.png" alt="" width="75%" class="inline"/> </p>
<p>Alternatively, you can navigate to <code>docs/html</code> and open the <a href="docs/html/index.html">index</a> file. This will open the html page in the browser and you can scroll through the documentation.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Code Profiling</h1>
<p>You can take advantage of the <a href="https://github.com/yse/easy_profiler">Easy Profiler library</a> in order to analyze the code and dive into the internals of the algorithms.</p>
<p>To use the profiling, the variable ENABLE_PROFILING needs to be defined. Be aware that toggling the profiler may affect performances.</p>
<p><img src="assets/misc/screenshot_profiler.png" alt="" width="100%" class="inline"/> </p>
<p>To toggle the profiling mode, you need to build the project accordingly by setting ENABLE_PROFILING=ON.</p>
<div class="fragment"><div class="line">cmake -D ENABLE_PROFILING=ON -B build &amp;&amp; make -C build -j4</div>
</div><!-- fragment --><p>Changing the definition of ENABLE_PROFILING, requires you to rebuild the project. At every run, the collected data will be stored in 'code_profiling/profile.prof'.</p>
<p>This file can then be vizualised by using the Easy Profiler Visualizer. There should be an executable called 'profiler_gui' in the build directory of the Easy Profiler. You can use this to visualize everything in detail.</p>
<div class="fragment"><div class="line">./build/third_party/easy_profiler/bin/profiler_gui</div>
</div><!-- fragment --><p>Once you opened the visualizer, you can use the folder icon at the top left to open the 'profile.prof' file.</p>
<p>To stop profiling, clean build the project again using the instructions in the 'Building' section.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Notes</h1>
<ul>
<li>The grid maps and scenarios in <code>assets/maps/</code> are from <a href="https://movingai.com/benchmarks/mapf.html">MAPF benchmarks</a>.</li>
<li>To run the python scripts in the <code>assets</code> folder, you might need to download/update some of the python packages (like dash, plotly, pandas, ...).</li>
<li>LaCAM* variants are available in <a href="https://github.com/Kei18/lacam2/tags">tags</a>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Licence</h1>
<p>This software is released under the MIT License, see <a href="LICENCE.txt">LICENSE.txt</a>. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
